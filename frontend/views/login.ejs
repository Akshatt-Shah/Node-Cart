<!-- index.ejs -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<!-- <body> -->
<!-- <div class="container d-flex  justify-content-around ">
        <form action="/getprofile">

            <div class="container border-4">
                <div class="row  ">
                    <div class="col mt-5 ">

                        <label for="" class="form-label">UserName</label>
                        <input type="text" class="form-control" name="name" id="name" aria-describedby="helpId"
                            placeholder="Enter Your Name" />

                    </div>
                </div>
                <div class="row ">
                    <div class="col mt-5">

                        <label for="" class="form-label">UserName</label>
                        <input type="password" class="form-control" name="password" id="password"
                            aria-describedby="helpId" placeholder="Enter Your password" />

                    </div>
                </div>
                <div class="row">
                    <div class="col text-center mt-5 ">


                        <input type="button" class="btn btn-success btn-lg m-4" onclick="Submitdata()" value="Submit" />
                        <a href="signup">Signup...</a>
                    </div>
                </div>
            </div>

        </form>
    </div> -->

<body class="bg-light">
    <div class="container d-flex justify-content-center vw-100 vh-100  ">
        <div class="container w-50  bg-dark m-auto rounded-5 p-4">
            <form class="form" id="form" action="/getprofile">
                <div class="row">
                    <div class="col text-center  text-light">
                        <h1>Login Form </h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="" class="form-label">Name</label>
                        <input type="text" class="form-control" name="name" id="name" aria-describedby="helpId"
                            placeholder="Enter Your Username" />
                        <small id="helpId" class="form-text text-muted">Help text</small>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="" class="form-label">Password</label>
                        <input type="text" class="form-control" name="password" id="password" aria-describedby="helpId"
                            placeholder="Enter Your Password" />
                        <small id="helpId" class="form-text text-muted">Help text</small>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col text-center">

                        <input type="button" class="btn btn-success btn-lg" value="Submit" onclick="Submitdata()" />
                        <a href="/signup">Signup...</a>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <script>
        // function Submitdata() {


        // Fetch data from the API endpoint
        // fetch('http://localhost:3000/loginuser')
        //     .then(response => response.json())

        //     .catch(error => {
        //         console.error('Error fetching products:', error);
        //         // Handle errors
        //     });

        // }

        async function Submitdata(req, res) {
            // e.preventDefault();
            const name = document.getElementById('name').value;
            const password = document.getElementById('password').value;
            console.log(name, password)

            try {
                // Send a POST request to the /loginuser endpoint with the username and password
                const response = await axios.post('http://localhost:3000/loginuser', { name, password });
                if (response) {
                    console.log(response)
                }
                else {
                    console.log(response)
                }
                // Handle the response from the server
                // console.log(response.data);
                const token = (response.data.token);
                // console.log(token)

                // Send a GET request to /getprofile with the token in the authorization header
                // console.log(token)
                // const profileResponse = await axios.get('http://localhost:3000/getprofile', {
                //     headers: {
                //         'Authorization': `${token}`
                //     }
                // });
                // if (profileResponse.status === 200) {

                sessionStorage.setItem('user_token', token)
                window.location.replace('/getprofile');
                // }
                // else
                //     console.log(profileResponse)
            } catch (error) {
                // Handle errors
                console.error('Error:', error);
            }
        }



    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="
        https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"
        integrity="sha512-PJa3oQSLWRB7wHZ7GQ/g+qyv6r4mbuhmiDb8BjSFZ8NZ2a42oTtAq5n0ucWAwcQDlikAtkub+tPVCw4np27WCg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>

</html>